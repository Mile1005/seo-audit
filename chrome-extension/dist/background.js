(()=>{"use strict";const e={showBadge:!0};function t(e,t){const s=e>=0?String(e):"";chrome.action.setBadgeText({text:s,...void 0!==t?{tabId:t}:{}}),chrome.action.setBadgeBackgroundColor({color:e>=80?"#4caf50":e>=50?"#ff9800":"#f44336",...void 0!==t?{tabId:t}:{}})}chrome.runtime.onMessage.addListener((s,o,a)=>{return"GET_PREFS"===s.type?(new Promise(t=>{chrome.storage.sync.get(e,e=>{t(e)})}).then(a),!0):"SET_PREFS"===s.type?((c=s.prefs,new Promise(e=>{chrome.storage.sync.set(c,()=>e())})).then(()=>a({success:!0})),!0):"SEO_SCORE_UPDATE"===s.type?("number"==typeof s.score&&("number"==typeof o.tab?.id?t(s.score,o.tab.id):t(s.score)),a({success:!0}),!0):"PASS_TO_CONTENT"===s.type&&o.tab?.id?(chrome.tabs.sendMessage(o.tab.id,s.payload,a),!0):void 0;var c}),chrome.tabs.onActivated.addListener(async e=>{try{chrome.action.setBadgeText({text:"",tabId:e.tabId})}catch(e){}}),chrome.tabs.onUpdated.addListener((e,t,s)=>{"complete"===t.status&&chrome.action.setBadgeText({text:"",tabId:e})}),chrome.runtime.onInstalled.addListener(()=>{chrome.contextMenus.create({id:"analyze-seo",title:"Analyze SEO",contexts:["page"]})}),chrome.contextMenus.onClicked.addListener((e,t)=>{if("analyze-seo"===e.menuItemId&&"number"==typeof t?.id){const e=t.id;chrome.tabs.sendMessage(e,{type:"GET_SEO_DATA"},t=>{chrome.runtime.lastError&&chrome.scripting.executeScript({target:{tabId:e},files:["content.js"]},()=>{chrome.tabs.sendMessage(e,{type:"GET_SEO_DATA"})})})}})})();